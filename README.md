# ML service for production

В этом репозитории вы найдёт пример того, как упаковать обученную ML модель в самостоятельный сервис, который может быть использовать в production окружении.

## Стек технологий
![Python](https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54)
![Pandas](https://img.shields.io/badge/pandas-%23150458.svg?style=for-the-badge&logo=pandas&logoColor=white)
![NumPy](https://img.shields.io/badge/numpy-%23013243.svg?style=for-the-badge&logo=numpy&logoColor=white)
![scikit-learn](https://img.shields.io/badge/scikit--learn-%23F7931E.svg?style=for-the-badge&logo=scikit-learn&logoColor=white)




## Локальный запуск проекта:
1. Склонируйте проект в рабочую директорию.
2. Установите виртуальное окружение 
python -m venv venv
3. Запустите виртуальное окружение
source venv/bin/activate (source venv/scripts/activate)
4. Из папки src установите зависимости pip install -r requirements.txt
5. Запустите файл app.py

Приложение будет развернуто на localhost:8000
Список эндпоинтов:
/health - тест работы
/pack - запрос на работу модели

## Описание модели:

### Работа модели
Данная модель осуществляет подбор упаковок для заказа из любого (1 и более) количества товаров.

Число уникальных SKU в заказе и количество однотипных предметов не ограничены.

Алгоритм модели включает:
1) разделение грузов на крупногабаритные и малогабаритные (на основании размеров доступных упаковок);
2) два бинарных классификатора:
-  классификатор крупногабаритных грузов: доставка без упаковки или упаковка в стретч-плёнку;
-  классификатор малогабаритных грузов: позволяет выделить товары, нуждающиеся в жёсткой упаковке или пригодные к транспортировке в пакете;
3) алгоритм упаковки: в зависимости от результатов классификации группам товаров подбирается упаковка, подходящая по размеру и объёму.

Для корректной рекомендации модель нуждается данных об упаковках и данных о товарах, сохранённых в .csv-таблицах. Подробнее о содержании таблиц и пайплайне, который позволяет сформировать их из "сырых" данных автоматически, можно узнать по ссылке: https://drive.google.com/file/d/18yX-MHU0PebW2dlDvjLRZlMf8edoQtPA/view?usp=drive_link

Все необходимые классы и элементы пайплайна данных можно найти по данной ссылке: https://drive.google.com/drive/folders/1-Dz2YUWtHKsSLvmxlDssJ3OdMJseaDrA



### Элементы модели

При запуске assembled_model.py обращается к следующим файлам, которые должны находиться в папке /mdata:
1) Классы:
  - class_predictor.py: принимает последовательность sku, обогащает данные, осуществляет классификацию.
  - class_packer.py: принимает предсказание class_predictor и применяет к нему алгоритм упаковки.
2) Модели:
  - model_big.pcl - классификатор крупногабаритных грузов;
  - model_small.pcl - классификатор малогабаритных грузов.
3) Таблицы данных:
  - carton_full_features.csv - информация об упаковках, в которые будут сложены товары;
  - full_sku_data.csv - необходимая информация для классификации товаров.

Подробную схему алгоритма можно увидеть по ссылке: 
https://drive.google.com/file/d/1X9FE5YqNQT1iuARXZoYUd8U9LX7WbYVU/view?usp=drive_link
